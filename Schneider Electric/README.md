# SAILES - Supervised Artificial Intelligence Learning Explainable System

This project is a Streamlit web application designed to provide predictions and explanations for a sales deal classification model (Won/Lost). It features a live prediction tool with SHAP-based explanations and a chatbot for querying the model's general behavior.

## ğŸš€ Features

- **Live Predictions**: Input details of a sales opportunity and get a real-time prediction on whether the deal will be Won or Lost.
- **Local Explanations**: Understand *why* a specific prediction was made using a SHAP waterfall plot and a natural language explanation generated by a Large Language Model (LLM).
- **Global Explanations**: A chatbot interface to ask high-level questions about the model's overall strategy and important features.
- **Counterfactuals**: For deals predicted as "Lost", the system suggests the minimal changes required to flip the prediction to "Won".

## ğŸ“‚ Project Structure

```
â”œâ”€â”€ data/
â”‚   â””â”€â”€ schneider_data.csv          # Raw dataset (assumed)
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ model.pkl                   # Trained classification model
â”‚   â”œâ”€â”€ explainer.pkl               # SHAP explainer object
â”‚   â”œâ”€â”€ model_7features.pkl         # Model for counterfactuals
â”‚   â”œâ”€â”€ vae.h5                       # VAE model for counterfactuals
â”‚   â””â”€â”€ scaler.pkl                   # Scaler for counterfactuals
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ train_model.py               # Script to train the model and save artifacts
â”‚   â””â”€â”€ generate_shap.py             # Script to generate and save the SHAP explainer
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py                     # Configuration and prompts
â”‚   â”œâ”€â”€ ui.py                         # Streamlit UI component functions
â”‚   â””â”€â”€ utils.py                      # Helper functions for loading assets and logic
â”œâ”€â”€ run.py                            # Master script to run the training pipeline
â”œâ”€â”€ streamlit.py                      # Main Streamlit application file
â”œâ”€â”€ requirements.txt                  # Python package dependencies
â””â”€â”€ README.md                         # This file
â””â”€â”€ SAILES_Technical_Report.ipynb.md  # Report of the analysis
```

## âš™ï¸ Setup and Usage

### 1. Installation

First, clone the repository and install the required Python packages.

```bash
git clone <your-repo-url>
cd <your-repo-directory>
pip install -r requirements.txt
```

### 2. Generate Model and Explainer

Before running the web app, you need to train the model and generate the SHAP explainer. The `run.py` script automates this process.

```bash
python run.py
```

This will execute `src/train_model.py` and then `src/generate_shap.py`, placing the necessary `.pkl` files in the `/model` directory.

### 3. Run the Streamlit Application

Once the model artifacts are in place, you can launch the web application.

```bash
streamlit run streamlit.py
```

Open your web browser and navigate to the local URL provided by Streamlit (usually `http://localhost:8501`).